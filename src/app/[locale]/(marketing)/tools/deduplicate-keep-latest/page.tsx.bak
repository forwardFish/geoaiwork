import type { Metadata } from 'next';
import { setRequestLocale } from 'next-intl/server';
import { ToolWorkbench } from '@/components/ToolWorkbench';
import { SEO_KEYWORDS_CORE, SEO_KEYWORDS_DEDUPE } from '@/lib/seo-keywords';

type IToolProps = {
  params: Promise<{ locale: string }>;
};

export async function generateMetadata(): Promise<Metadata> {
  return {
    title: 'Excel去重保留最新记录工具 - 智能聚合数据 | SheetAlly',
    description: 'Excel删除重复项但保留最新记录，支持按日期、版本、分数等字段智能去重，同时自动聚合汇总其他列数据。告别Excel原生去重功能的局限性。',
    keywords: [...SEO_KEYWORDS_CORE, ...SEO_KEYWORDS_DEDUPE],
    openGraph: {
      title: 'Excel去重保留最新记录工具 - 智能聚合数据',
      description: 'Excel删除重复项但保留最新记录，支持智能去重+数据聚合。解决Excel原生删除重复项功能不支持保留策略的痛点。',
      type: 'website',
      url: 'https://sheetally.com/tools/deduplicate-keep-latest',
      siteName: 'SheetAlly',
    },
    twitter: {
      card: 'summary_large_image',
      title: 'Excel去重保留最新记录工具',
      description: 'Excel删除重复项但保留最新记录，智能聚合数据。',
    },
    alternates: {
      canonical: 'https://sheetally.com/tools/deduplicate-keep-latest',
    },
  };
}

export default async function DeduplicateKeepLatest(props: IToolProps) {
  const { locale } = await props.params;
  setRequestLocale(locale);

  return (
    <div className="min-h-screen bg-gray-50">
      <div className="container mx-auto px-4 py-8">
        {/* SEO优化的页面标题和描述 */}
        <div className="mb-8 text-center">
          <h1 className="mb-4 text-4xl font-bold text-gray-900">
            Excel去重保留最新：一键删除重复数据并聚合统计
          </h1>
          <p className="mx-auto max-w-3xl text-xl text-gray-600">
            解决Excel原生"删除重复项"功能的局限性，智能保留最新记录的同时自动聚合其他列数据。
            适用于销售数据去重、客户记录整理、订单管理等场景。
          </p>
        </div>

        {/* 痛点说明 */}
        <div className="mb-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-4 text-2xl font-semibold text-gray-800">
            解决Excel去重的3大痛点
          </h2>
          <div className="grid gap-6 md:grid-cols-3">
            <div className="text-center">
              <div className="mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-red-100">
                <span className="font-bold text-red-600">1</span>
              </div>
              <h3 className="mb-2 font-semibold">无法指定保留策略</h3>
              <p className="text-sm text-gray-600">
                Excel原生删除重复项随机保留，无法按日期、版本等字段保留最新记录
              </p>
            </div>
            <div className="text-center">
              <div className="mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-red-100">
                <span className="font-bold text-red-600">2</span>
              </div>
              <h3 className="mb-2 font-semibold">无法同时聚合数据</h3>
              <p className="text-sm text-gray-600">
                删除重复行后，无法自动计算重复记录的金额汇总、数量统计等聚合数据
              </p>
            </div>
            <div className="text-center">
              <div className="mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-red-100">
                <span className="font-bold text-red-600">3</span>
              </div>
              <h3 className="mb-2 font-semibold">操作步骤繁琐</h3>
              <p className="text-sm text-gray-600">
                需要先排序、再删除重复项、最后手动计算聚合，容易出错且耗时
              </p>
            </div>
          </div>
        </div>

        {/* 解决方案展示 */}
        <div className="mb-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-4 text-2xl font-semibold text-gray-800">
            SheetAlly智能去重解决方案
          </h2>
          <div className="grid gap-8 md:grid-cols-2">
            <div>
              <h3 className="mb-3 text-lg font-semibold text-green-600">
                ✓ 智能保留策略
              </h3>
              <ul className="space-y-2 text-gray-600">
                <li>• 按日期字段保留最新记录</li>
                <li>• 按版本号保留最高版本</li>
                <li>• 按分数保留最优记录</li>
                <li>• 支持多字段组合去重</li>
              </ul>
            </div>
            <div>
              <h3 className="mb-3 text-lg font-semibold text-green-600">
                ✓ 自动数据聚合
              </h3>
              <ul className="space-y-2 text-gray-600">
                <li>• 金额自动求和汇总</li>
                <li>• 数量自动计数统计</li>
                <li>• 支持最大值、最小值</li>
                <li>• 一键生成聚合列</li>
              </ul>
            </div>
          </div>
        </div>

        {/* 使用场景 */}
        <div className="mb-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-4 text-2xl font-semibold text-gray-800">
            适用场景
          </h2>
          <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
            <div className="rounded-lg border border-gray-200 p-4 text-center">
              <h4 className="mb-2 font-semibold">销售数据</h4>
              <p className="text-sm text-gray-600">
                客户重复订单保留最新，汇总历史交易金额
              </p>
            </div>
            <div className="rounded-lg border border-gray-200 p-4 text-center">
              <h4 className="mb-2 font-semibold">客户记录</h4>
              <p className="text-sm text-gray-600">
                同一客户多条记录保留最新，合并联系方式
              </p>
            </div>
            <div className="rounded-lg border border-gray-200 p-4 text-center">
              <h4 className="mb-2 font-semibold">库存管理</h4>
              <p className="text-sm text-gray-600">
                产品重复入库保留最新，汇总总库存数量
              </p>
            </div>
            <div className="rounded-lg border border-gray-200 p-4 text-center">
              <h4 className="mb-2 font-semibold">员工信息</h4>
              <p className="text-sm text-gray-600">
                员工信息更新保留最新，统计工作年限
              </p>
            </div>
          </div>
        </div>

        {/* 工具操作区域 */}
        <ToolWorkbench />

        {/* FAQ部分 */}
        <div className="mt-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-6 text-2xl font-semibold text-gray-800">
            常见问题
          </h2>
          <div className="space-y-4">
            <div>
              <h3 className="mb-2 font-semibold">Q: Excel原生删除重复项和SheetAlly有什么区别？</h3>
              <p className="text-gray-600">
                A: Excel原生功能只能随机保留一条记录，而SheetAlly可以指定按日期、版本等字段保留最新记录，同时支持数据聚合。
              </p>
            </div>
            <div>
              <h3 className="mb-2 font-semibold">Q: 可以同时按多个字段去重吗？</h3>
              <p className="text-gray-600">
                A: 可以。支持选择多个列作为去重键，比如同时按"客户ID"和"产品编号"进行组合去重。
              </p>
            </div>
            <div>
              <h3 className="mb-2 font-semibold">Q: 聚合功能支持哪些计算方式？</h3>
              <p className="text-gray-600">
                A: 支持求和(SUM)、计数(COUNT)、最大值(MAX)、最小值(MIN)等常用聚合函数。
              </p>
            </div>
            <div>
              <h3 className="mb-2 font-semibold">Q: 处理后的数据可以导出吗？</h3>
              <p className="text-gray-600">
                A: 可以导出为标准Excel文件，包含处理结果、操作配方和详细报告。
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
