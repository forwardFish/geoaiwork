import type { Metadata } from 'next';
import { setRequestLocale } from 'next-intl/server';
import { ToolWorkbench } from '@/components/ToolWorkbench';
import { SEO_KEYWORDS_CORE, SEO_KEYWORDS_TEXT } from '@/lib/seo-keywords';

type IToolProps = {
  params: Promise<{ locale: string }>;
};

export async function generateMetadata(): Promise<Metadata> {
  return {
    title: 'Excel文本拆分清洗工具 - 姓名地址批量分列 | SheetAlly',
    description: 'Excel姓名分列、地址拆分、电话号码清洗一键搞定。支持中英文姓名智能拆分，批量处理脏数据，告别复杂的正则表达式和Power Query。',
    keywords: [...SEO_KEYWORDS_CORE, ...SEO_KEYWORDS_TEXT],
    openGraph: {
      title: 'Excel文本拆分清洗工具 - 姓名地址批量分列',
      description: 'Excel姓名分列、地址拆分一键搞定。支持中英文姓名智能拆分，告别复杂的文本处理。',
      type: 'website',
      url: 'https://sheetally.com/tools/text-clean-split',
      siteName: 'SheetAlly',
    },
    twitter: {
      card: 'summary_large_image',
      title: 'Excel文本拆分清洗工具',
      description: 'Excel姓名分列、地址拆分一键搞定。',
    },
    alternates: {
      canonical: 'https://sheetally.com/tools/text-clean-split',
    },
  };
}

export default async function TextCleanSplit(props: IToolProps) {
  const { locale } = await props.params;
  setRequestLocale(locale);

  return (
    <div className="min-h-screen bg-gray-50">
      <div className="container mx-auto px-4 py-8">
        <div className="mb-8 text-center">
          <h1 className="mb-4 text-4xl font-bold text-gray-900">
            Excel文本拆分清洗：姓名地址智能分列，批量处理脏数据
          </h1>
          <p className="mx-auto max-w-3xl text-xl text-gray-600">
            告别复杂的正则表达式和Power Query，一键完成Excel文本拆分。
            支持中英文姓名智能识别、地址分段提取、电话号码格式化等常见文本处理需求。
          </p>
        </div>

        {/* Excel文本处理痛点 */}
        <div className="mb-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-4 text-2xl font-semibold text-gray-800">
            解决Excel文本处理的5大痛点
          </h2>
          <div className="grid gap-4 md:grid-cols-5">
            <div className="text-center">
              <div className="mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-red-100">
                <span className="font-bold text-red-600">1</span>
              </div>
              <h3 className="mb-2 text-sm font-semibold">分列功能有限</h3>
              <p className="text-xs text-gray-600">
                Excel原生分列只支持简单分隔符，无法处理复杂的中英文姓名
              </p>
            </div>
            <div className="text-center">
              <div className="mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-red-100">
                <span className="font-bold text-red-600">2</span>
              </div>
              <h3 className="mb-2 text-sm font-semibold">正则表达式门槛高</h3>
              <p className="text-xs text-gray-600">
                复杂的正则语法学习成本高，普通用户难以掌握
              </p>
            </div>
            <div className="text-center">
              <div className="mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-red-100">
                <span className="font-bold text-red-600">3</span>
              </div>
              <h3 className="mb-2 text-sm font-semibold">Power Query复杂</h3>
              <p className="text-xs text-gray-600">
                M语言学习难度大，文本处理函数复杂难懂
              </p>
            </div>
            <div className="text-center">
              <div className="mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-red-100">
                <span className="font-bold text-red-600">4</span>
              </div>
              <h3 className="mb-2 text-sm font-semibold">批量处理困难</h3>
              <p className="text-xs text-gray-600">
                逐行手动拆分耗时巨大，容易出错
              </p>
            </div>
            <div className="text-center">
              <div className="mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-red-100">
                <span className="font-bold text-red-600">5</span>
              </div>
              <h3 className="mb-2 text-sm font-semibold">格式不统一</h3>
              <p className="text-xs text-gray-600">
                数据来源多样，文本格式五花八门难以统一处理
              </p>
            </div>
          </div>
        </div>

        {/* 智能拆分解决方案 */}
        <div className="mb-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-4 text-2xl font-semibold text-gray-800">
            AI智能文本拆分解决方案
          </h2>
          <div className="grid gap-8 md:grid-cols-2">
            <div>
              <h3 className="mb-4 flex items-center text-lg font-semibold text-green-600">
                <svg className="mr-2 h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                智能姓名识别
              </h3>
              <ul className="space-y-2 text-gray-600">
                <li>
                  •
                  <strong>中文姓名：</strong>
                  "张三" → "张" + "三"
                </li>
                <li>
                  •
                  <strong>英文姓名：</strong>
                  "John Smith" → "John" + "Smith"
                </li>
                <li>
                  •
                  <strong>复合姓名：</strong>
                  "李小明" → "李" + "小明"
                </li>
                <li>
                  •
                  <strong>带称谓：</strong>
                  "张先生" → "张" + "先生"
                </li>
              </ul>
            </div>
            <div>
              <h3 className="mb-4 flex items-center text-lg font-semibold text-green-600">
                <svg className="mr-2 h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                </svg>
                地址智能拆分
              </h3>
              <ul className="space-y-2 text-gray-600">
                <li>
                  •
                  <strong>省市区：</strong>
                  "北京市朝阳区" → "北京市" + "朝阳区"
                </li>
                <li>
                  •
                  <strong>详细地址：</strong>
                  自动识别街道、门牌号
                </li>
                <li>
                  •
                  <strong>邮编提取：</strong>
                  自动识别6位邮政编码
                </li>
                <li>
                  •
                  <strong>格式统一：</strong>
                  标准化地址格式
                </li>
              </ul>
            </div>
          </div>
        </div>

        {/* 支持的拆分模式 */}
        <div className="mb-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-4 text-2xl font-semibold text-gray-800">
            支持的拆分模式
          </h2>
          <div className="grid gap-4 md:grid-cols-4">
            <div className="rounded-lg border border-gray-200 p-4">
              <div className="mb-3 text-center">
                <div className="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-blue-100">
                  <span className="font-bold text-blue-600">分</span>
                </div>
              </div>
              <h3 className="mb-2 text-center font-semibold">分隔符拆分</h3>
              <p className="mb-2 text-center text-sm text-gray-600">
                按逗号、空格、制表符等分隔
              </p>
              <div className="text-xs text-gray-500">
                示例：
                <br />
                "苹果,香蕉,橙子" → "苹果" | "香蕉" | "橙子"
              </div>
            </div>
            <div className="rounded-lg border border-gray-200 p-4">
              <div className="mb-3 text-center">
                <div className="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100">
                  <span className="font-bold text-green-600">正</span>
                </div>
              </div>
              <h3 className="mb-2 text-center font-semibold">正则表达式</h3>
              <p className="mb-2 text-center text-sm text-gray-600">
                支持复杂的模式匹配
              </p>
              <div className="text-xs text-gray-500">
                示例：
                <br />
                提取邮箱用户名和域名
              </div>
            </div>
            <div className="rounded-lg border border-gray-200 p-4">
              <div className="mb-3 text-center">
                <div className="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-purple-100">
                  <span className="font-bold text-purple-600">中</span>
                </div>
              </div>
              <h3 className="mb-2 text-center font-semibold">中文姓名</h3>
              <p className="mb-2 text-center text-sm text-gray-600">
                智能识别中文姓氏和名字
              </p>
              <div className="text-xs text-gray-500">
                示例：
                <br />
                "王小明" → "王" | "小明"
              </div>
            </div>
            <div className="rounded-lg border border-gray-200 p-4">
              <div className="mb-3 text-center">
                <div className="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-orange-100">
                  <span className="font-bold text-orange-600">EN</span>
                </div>
              </div>
              <h3 className="mb-2 text-center font-semibold">英文姓名</h3>
              <p className="mb-2 text-center text-sm text-gray-600">
                按空格拆分英文姓名
              </p>
              <div className="text-xs text-gray-500">
                示例：
                <br />
                "John Smith" → "John" | "Smith"
              </div>
            </div>
          </div>
        </div>

        {/* 常见使用场景 */}
        <div className="mb-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-4 text-2xl font-semibold text-gray-800">
            常见使用场景
          </h2>
          <div className="space-y-6">
            <div className="flex items-start space-x-4">
              <div className="flex-shrink-0 rounded-lg bg-blue-100 p-3">
                <svg className="h-6 w-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
              </div>
              <div className="flex-1">
                <h3 className="mb-2 text-lg font-semibold">👥 客户信息管理</h3>
                <p className="mb-2 text-gray-600">
                  将"联系人"列拆分为"姓"和"名"，便于个性化称呼；
                  将"联系方式"拆分为"手机"和"邮箱"，便于分类管理。
                </p>
                <div className="rounded bg-gray-100 p-3 text-sm">
                  <strong>处理前：</strong>
                  联系人: "张小明", 联系方式: "13812345678,zhang@email.com"
                  <br />
                  <strong>处理后：</strong>
                  姓: "张", 名: "小明", 手机: "13812345678", 邮箱: "zhang@email.com"
                </div>
              </div>
            </div>

            <div className="flex items-start space-x-4">
              <div className="flex-shrink-0 rounded-lg bg-green-100 p-3">
                <svg className="h-6 w-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                </svg>
              </div>
              <div className="flex-1">
                <h3 className="mb-2 text-lg font-semibold">📍 物流地址处理</h3>
                <p className="mb-2 text-gray-600">
                  将完整地址拆分为"省份"、"城市"、"区县"、"详细地址"，
                  便于地域分析和运费计算。
                </p>
                <div className="rounded bg-gray-100 p-3 text-sm">
                  <strong>处理前：</strong>
                  "北京市朝阳区建国门外大街1号国贸大厦A座1001室"
                  <br />
                  <strong>处理后：</strong>
                  省份: "北京市", 区县: "朝阳区", 详细地址: "建国门外大街1号国贸大厦A座1001室"
                </div>
              </div>
            </div>

            <div className="flex items-start space-x-4">
              <div className="flex-shrink-0 rounded-lg bg-purple-100 p-3">
                <svg className="h-6 w-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
              </div>
              <div className="flex-1">
                <h3 className="mb-2 text-lg font-semibold">📋 人事档案整理</h3>
                <p className="mb-2 text-gray-600">
                  将员工"姓名"拆分便于排序，将"身份证号"提取生日和性别信息，
                  将"毕业院校专业"拆分为独立字段。
                </p>
                <div className="rounded bg-gray-100 p-3 text-sm">
                  <strong>处理前：</strong>
                  "李小红", "清华大学计算机科学与技术专业"
                  <br />
                  <strong>处理后：</strong>
                  姓: "李", 名: "小红", 学校: "清华大学", 专业: "计算机科学与技术"
                </div>
              </div>
            </div>
          </div>
        </div>

        {/* 工具操作区域 */}
        <ToolWorkbench />

        {/* 智能识别特色 */}
        <div className="mt-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-4 text-2xl font-semibold text-gray-800">
            智能识别特色功能
          </h2>
          <div className="grid gap-8 md:grid-cols-2">
            <div>
              <h3 className="mb-3 text-lg font-semibold text-blue-600">🎯 自动模式检测</h3>
              <p className="mb-3 text-gray-600">
                系统会自动分析文本内容，智能推荐最合适的拆分模式：
              </p>
              <ul className="space-y-1 text-sm text-gray-600">
                <li>• 检测到中文姓名模式时自动建议使用"中文姓名"拆分</li>
                <li>• 识别常见分隔符(逗号、空格、分号)时建议分隔符拆分</li>
                <li>• 发现邮箱、电话等格式时提供专用拆分模板</li>
              </ul>
            </div>
            <div>
              <h3 className="mb-3 text-lg font-semibold text-green-600">🔍 不确定样本提示</h3>
              <p className="mb-3 text-gray-600">
                对于无法确定的拆分结果，系统会标记并提供人工复核：
              </p>
              <ul className="space-y-1 text-sm text-gray-600">
                <li>• 复杂格式的文本会标记为"需要复核"</li>
                <li>• 提供前50个不确定样本供用户检查</li>
                <li>• 支持批量调整不确定样本的拆分规则</li>
              </ul>
            </div>
          </div>
        </div>

        {/* FAQ */}
        <div className="mt-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-6 text-2xl font-semibold text-gray-800">
            常见问题
          </h2>
          <div className="space-y-4">
            <div>
              <h3 className="mb-2 font-semibold">Q: 中文姓名拆分的准确率如何？</h3>
              <p className="text-gray-600">
                A: 对于常见的2-3字姓名，准确率可达95%以上。复杂的复姓或少数民族姓名会标记为不确定样本供复核。
              </p>
            </div>
            <div>
              <h3 className="mb-2 font-semibold">Q: 可以自定义拆分规则吗？</h3>
              <p className="text-gray-600">
                A: 可以。支持自定义分隔符、正则表达式，也可以为特定的文本格式创建专用的拆分模板。
              </p>
            </div>
            <div>
              <h3 className="mb-2 font-semibold">Q: 拆分后的列名可以自定义吗？</h3>
              <p className="text-gray-600">
                A: 完全可以。您可以为拆分后的每一列指定列名，如"姓氏"、"名字"、"省份"、"城市"等。
              </p>
            </div>
            <div>
              <h3 className="mb-2 font-semibold">Q: 如何处理拆分失败的数据？</h3>
              <p className="text-gray-600">
                A: 系统会将无法拆分的数据保留在原列中，并在报告中标注。您可以导出不确定样本进行手动处理。
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
