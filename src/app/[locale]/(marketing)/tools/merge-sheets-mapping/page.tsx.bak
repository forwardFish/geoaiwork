import type { Metadata } from 'next';
import { setRequestLocale } from 'next-intl/server';
import { ToolWorkbench } from '@/components/ToolWorkbench';
import { SEO_KEYWORDS_CORE, SEO_KEYWORDS_MERGE } from '@/lib/seo-keywords';

type IToolProps = {
  params: Promise<{ locale: string }>;
};

export async function generateMetadata(): Promise<Metadata> {
  return {
    title: 'Excel表格智能合并工具 - 列名映射匹配 | SheetAlly',
    description: 'Excel表格合并列名不匹配？AI智能识别相似列名，自动建议映射关系。支持左连接、内连接，完美替代复杂的VLOOKUP操作。',
    keywords: [...SEO_KEYWORDS_CORE, ...SEO_KEYWORDS_MERGE],
    openGraph: {
      title: 'Excel表格智能合并工具 - 列名映射匹配',
      description: 'AI智能识别Excel表格相似列名，自动建议映射关系。告别VLOOKUP在列名不匹配时的痛苦。',
      type: 'website',
      url: 'https://sheetally.com/tools/merge-sheets-mapping',
      siteName: 'SheetAlly',
    },
    twitter: {
      card: 'summary_large_image',
      title: 'Excel表格智能合并工具',
      description: 'AI智能列名匹配，Excel表格合并不再困难。',
    },
    alternates: {
      canonical: 'https://sheetally.com/tools/merge-sheets-mapping',
    },
  };
}

export default async function MergeSheetsMapping(props: IToolProps) {
  const { locale } = await props.params;
  setRequestLocale(locale);

  return (
    <div className="min-h-screen bg-gray-50">
      <div className="container mx-auto px-4 py-8">
        <div className="mb-8 text-center">
          <h1 className="mb-4 text-4xl font-bold text-gray-900">
            Excel表格智能合并：AI列名匹配，告别VLOOKUP烦恼
          </h1>
          <p className="mx-auto max-w-3xl text-xl text-gray-600">
            解决Excel表格合并时列名不匹配的痛点，AI智能识别相似列名并建议映射关系。
            支持多种连接方式，完美替代复杂的VLOOKUP操作。
          </p>
        </div>

        {/* VLOOKUP痛点说明 */}
        <div className="mb-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-4 text-2xl font-semibold text-gray-800">
            解决VLOOKUP的4大痛点
          </h2>
          <div className="grid gap-6 md:grid-cols-2">
            <div className="flex items-start space-x-3">
              <div className="mt-1 flex h-8 w-8 items-center justify-center rounded-full bg-red-100">
                <span className="text-sm font-bold text-red-600">1</span>
              </div>
              <div>
                <h3 className="mb-1 font-semibold">列名不匹配无法查找</h3>
                <p className="text-sm text-gray-600">
                  "客户姓名" vs "姓名"、"Product ID" vs "产品编号"等列名差异导致VLOOKUP失效
                </p>
              </div>
            </div>
            <div className="flex items-start space-x-3">
              <div className="mt-1 flex h-8 w-8 items-center justify-center rounded-full bg-red-100">
                <span className="text-sm font-bold text-red-600">2</span>
              </div>
              <div>
                <h3 className="mb-1 font-semibold">需要手动调整列顺序</h3>
                <p className="text-sm text-gray-600">
                  VLOOKUP要求查找列在左侧，返回列在右侧，经常需要调整表格结构
                </p>
              </div>
            </div>
            <div className="flex items-start space-x-3">
              <div className="mt-1 flex h-8 w-8 items-center justify-center rounded-full bg-red-100">
                <span className="text-sm font-bold text-red-600">3</span>
              </div>
              <div>
                <h3 className="mb-1 font-semibold">公式复杂容易出错</h3>
                <p className="text-sm text-gray-600">
                  INDEX+MATCH组合复杂，绝对引用容易遗漏，数组公式难以理解
                </p>
              </div>
            </div>
            <div className="flex items-start space-x-3">
              <div className="mt-1 flex h-8 w-8 items-center justify-center rounded-full bg-red-100">
                <span className="text-sm font-bold text-red-600">4</span>
              </div>
              <div>
                <h3 className="mb-1 font-semibold">无法批量处理多表</h3>
                <p className="text-sm text-gray-600">
                  多个供应商、多个部门的Excel表格需要逐个处理，重复工作量大
                </p>
              </div>
            </div>
          </div>
        </div>

        {/* AI智能解决方案 */}
        <div className="mb-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-4 text-2xl font-semibold text-gray-800">
            AI智能合并解决方案
          </h2>
          <div className="grid gap-6 md:grid-cols-3">
            <div className="text-center">
              <div className="mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-green-100">
                <svg className="h-8 w-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <h3 className="mb-2 font-semibold">智能列名识别</h3>
              <p className="text-sm text-gray-600">
                AI自动识别"客户姓名"="姓名"、"Product ID"="产品编号"等相似列名
              </p>
            </div>
            <div className="text-center">
              <div className="mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-green-100">
                <svg className="h-8 w-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
              </div>
              <h3 className="mb-2 font-semibold">一键映射确认</h3>
              <p className="text-sm text-gray-600">
                系统自动建议列名映射关系，用户确认后立即执行合并
              </p>
            </div>
            <div className="text-center">
              <div className="mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-green-100">
                <svg className="h-8 w-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 7v10c0 2.21 3.57 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.57 4 8 4s8-1.79 8-4M4 7c0-2.21 3.57-4 8-4s8 1.79 8 4" />
                </svg>
              </div>
              <h3 className="mb-2 font-semibold">多种连接方式</h3>
              <p className="text-sm text-gray-600">
                支持左连接、内连接、右连接，保留或过滤未匹配的数据
              </p>
            </div>
          </div>
        </div>

        {/* 使用场景展示 */}
        <div className="mb-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-4 text-2xl font-semibold text-gray-800">
            典型使用场景
          </h2>
          <div className="space-y-6">
            <div className="border-l-4 border-blue-500 pl-6">
              <h3 className="mb-2 text-lg font-semibold">📊 财务数据整合</h3>
              <p className="mb-2 text-gray-600">
                将多个部门的费用报表合并，自动匹配"费用类别"与"支出类型"、"报销人"与"申请人"等不同列名。
              </p>
              <div className="text-sm text-gray-500">
                常见列名差异: 报销金额 ↔ 费用金额、部门名称 ↔ 所属部门
              </div>
            </div>
            <div className="border-l-4 border-green-500 pl-6">
              <h3 className="mb-2 text-lg font-semibold">🛒 供应商数据合并</h3>
              <p className="mb-2 text-gray-600">
                整合不同供应商的产品清单，智能匹配"商品名称"与"产品名"、"单价"与"价格"等字段。
              </p>
              <div className="text-sm text-gray-500">
                常见列名差异: 供应商编码 ↔ Vendor ID、交货期 ↔ 发货周期
              </div>
            </div>
            <div className="border-l-4 border-purple-500 pl-6">
              <h3 className="mb-2 text-lg font-semibold">👥 客户信息整理</h3>
              <p className="mb-2 text-gray-600">
                合并销售团队和客服团队的客户数据，自动识别"客户名称"与"公司名"、"联系方式"与"电话"。
              </p>
              <div className="text-sm text-gray-500">
                常见列名差异: 联系人 ↔ 负责人、注册地址 ↔ 公司地址
              </div>
            </div>
          </div>
        </div>

        {/* 操作步骤 */}
        <div className="mb-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-4 text-2xl font-semibold text-gray-800">
            简单4步完成智能合并
          </h2>
          <div className="grid gap-4 md:grid-cols-4">
            <div className="text-center">
              <div className="mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-blue-100">
                <span className="font-bold text-blue-600">1</span>
              </div>
              <h4 className="mb-1 font-semibold">上传两个表格</h4>
              <p className="text-xs text-gray-600">选择需要合并的Excel文件</p>
            </div>
            <div className="text-center">
              <div className="mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-blue-100">
                <span className="font-bold text-blue-600">2</span>
              </div>
              <h4 className="mb-1 font-semibold">确认列名映射</h4>
              <p className="text-xs text-gray-600">AI建议映射关系，手动调整</p>
            </div>
            <div className="text-center">
              <div className="mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-blue-100">
                <span className="font-bold text-blue-600">3</span>
              </div>
              <h4 className="mb-1 font-semibold">预览合并结果</h4>
              <p className="text-xs text-gray-600">查看合并效果和统计信息</p>
            </div>
            <div className="text-center">
              <div className="mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-blue-100">
                <span className="font-bold text-blue-600">4</span>
              </div>
              <h4 className="mb-1 font-semibold">导出Excel文件</h4>
              <p className="text-xs text-gray-600">获得完整的合并结果</p>
            </div>
          </div>
        </div>

        {/* 工具操作区域 */}
        <ToolWorkbench />

        {/* 对比优势 */}
        <div className="mt-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-4 text-2xl font-semibold text-gray-800">
            vs 传统VLOOKUP方法对比
          </h2>
          <div className="overflow-x-auto">
            <table className="w-full border-collapse border border-gray-300">
              <thead>
                <tr className="bg-gray-50">
                  <th className="border border-gray-300 px-4 py-2 text-left">对比项目</th>
                  <th className="border border-gray-300 px-4 py-2 text-center">传统VLOOKUP</th>
                  <th className="border border-gray-300 px-4 py-2 text-center">SheetAlly智能合并</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td className="border border-gray-300 px-4 py-2 font-medium">列名不匹配处理</td>
                  <td className="border border-gray-300 px-4 py-2 text-center text-red-600">❌ 需手动修改列名</td>
                  <td className="border border-gray-300 px-4 py-2 text-center text-green-600">✅ AI自动识别匹配</td>
                </tr>
                <tr className="bg-gray-50">
                  <td className="border border-gray-300 px-4 py-2 font-medium">操作复杂度</td>
                  <td className="border border-gray-300 px-4 py-2 text-center text-red-600">❌ 需要学习公式语法</td>
                  <td className="border border-gray-300 px-4 py-2 text-center text-green-600">✅ 可视化操作界面</td>
                </tr>
                <tr>
                  <td className="border border-gray-300 px-4 py-2 font-medium">错误率</td>
                  <td className="border border-gray-300 px-4 py-2 text-center text-red-600">❌ 公式容易出错</td>
                  <td className="border border-gray-300 px-4 py-2 text-center text-green-600">✅ 预览确认降低风险</td>
                </tr>
                <tr className="bg-gray-50">
                  <td className="border border-gray-300 px-4 py-2 font-medium">批量处理</td>
                  <td className="border border-gray-300 px-4 py-2 text-center text-red-600">❌ 需逐个文件处理</td>
                  <td className="border border-gray-300 px-4 py-2 text-center text-green-600">✅ 支持配方复用</td>
                </tr>
                <tr>
                  <td className="border border-gray-300 px-4 py-2 font-medium">处理时间</td>
                  <td className="border border-gray-300 px-4 py-2 text-center text-red-600">❌ 30-60分钟</td>
                  <td className="border border-gray-300 px-4 py-2 text-center text-green-600">✅ 3-5分钟</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        {/* FAQ */}
        <div className="mt-8 rounded-lg bg-white p-6 shadow-md">
          <h2 className="mb-6 text-2xl font-semibold text-gray-800">
            常见问题
          </h2>
          <div className="space-y-4">
            <div>
              <h3 className="mb-2 font-semibold">Q: AI如何识别相似的列名？</h3>
              <p className="text-gray-600">
                A: 系统使用字符串相似度算法和语义分析，可以识别"客户姓名"="姓名"、"Product ID"="产品编号"等常见的列名对应关系。
              </p>
            </div>
            <div>
              <h3 className="mb-2 font-semibold">Q: 如果AI建议的映射关系不对怎么办？</h3>
              <p className="text-gray-600">
                A: 可以手动调整映射关系。系统提供直观的拖拽界面，您可以轻松修改列名对应关系。
              </p>
            </div>
            <div>
              <h3 className="mb-2 font-semibold">Q: 支持哪些连接方式？</h3>
              <p className="text-gray-600">
                A: 支持左连接(保留左表所有数据)、内连接(只保留匹配数据)、右连接(保留右表所有数据)。
              </p>
            </div>
            <div>
              <h3 className="mb-2 font-semibold">Q: 合并后如何处理重复列名？</h3>
              <p className="text-gray-600">
                A: 右表的重复列名会自动添加"_r"后缀，如"金额"和"金额_r"，避免列名冲突。
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
